<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Login - Pasar Online</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <h2>Login</h2>

        <!-- Peringatan jika sudah login -->
        <div id="loginWarning" class="alert alert-warning" style="display: none;">
            <strong>Anda sudah login!</strong> Anda akan diarahkan ke halaman akun.
        </div>

        <!-- Peringatan jika login gagal -->
        <div id="loginError" class="alert alert-danger" style="display: none;">
            <strong>Login gagal!</strong> Cek kembali username dan password Anda.
        </div>

        <!-- Form Login -->
        <form id="loginForm" onsubmit="login(event)">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" class="form-control" id="username" required />
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" required />
            </div>
            <button type="submit" class="btn btn-primary">Login</button>
        </form>

        <!-- Link ke halaman registrasi -->
        <p class="mt-3">Belum punya akun? <a href="register.html">Daftar Sekarang</a></p>
    </div>

    <script>
        // Fungsi untuk memeriksa apakah pengguna sudah login
        function checkLoginStatus() {
            let user = localStorage.getItem('loggedInUser');
            if (user) {
                document.getElementById('loginWarning').style.display = 'block'; // Tampilkan peringatan
                setTimeout(function() {
                    window.location.href = 'akun.html'; // Arahkan ke halaman akun setelah 3 detik
                }, 3000); // Waktu tunggu 3 detik sebelum diarahkan
            }
        }

        // Fungsi untuk menangani login
        function login(event) {
            event.preventDefault(); // Mencegah form submit default

            // Ambil data dari form
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            

            // Mengambil data pengguna yang terdaftar
            let storedUser = JSON.parse(localStorage.getItem('registeredUser')); // Mendapatkan akun yang terdaftar di localStorage

            // Cek apakah data yang dimasukkan cocok dengan data yang terdaftar
            if (storedUser && storedUser.username === username && storedUser.password === password) {
                // Menyimpan data pengguna yang sudah login ke localStorage
                localStorage.setItem('loggedInUser', JSON.stringify({
                    username: username,
                    email: storedUser.email, // Menggunakan email yang sama dengan data yang disimpan
                    fullName: storedUser.fullName
                }));

                // Mengarahkan ke halaman akun
                window.location.href = 'akun.html';
            } else {
                // Menampilkan peringatan jika login gagal
                document.getElementById('loginError').style.display = 'block';
            }
        }

        // Panggil fungsi untuk memeriksa status login saat halaman dimuat
        checkLoginStatus();
    </script>
</body>
</html>
